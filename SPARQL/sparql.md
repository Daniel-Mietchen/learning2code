# SPARQL intro

* [Constructing SPARQL Queries](https://medium.com/wallscope/constructing-sparql-queries-ca63b8b9ac02) (seen [here](https://twitter.com/stevedischinger/status/1089895654078459906))
* [Using SPARQL to access Linked Open Data](https://programminghistorian.org/en/lessons/graph-databases-and-SPARQL)
  - > "explains why many cultural institutions are adopting graph databases, and how researchers can access these data though the query language called SPARQL"
* [SPARQL playground](http://sparql-playground.sib.swiss/help/doc/about)  

# SPARQL specs

* [at W3C](https://www.w3.org/TR/sparql11-query/#neg-notexists-minus)

# SPARQL tutorials

* [data.world's SPARQL tutorial](https://docs.data.world/tutorials/sparql/index.html)
  - generic

## SPARQL syntax

* [introduction](http://rdf.myexperiment.org/howtosparql?)
* https://www.w3.org/TR/sparql11-query/
* [.](https://data-gov.tw.rpi.edu/wiki/How_to_use_SPARQL#Query_syntax)
* namespaces
[![SPARQL data model](https://upload.wikimedia.org/wikipedia/commons/3/33/SPARQL_data_representation.png)](https://commons.wikimedia.org/wiki/File:SPARQL_data_representation.png)
  * [wdt:](http://stackoverflow.com/questions/42927634/wikidata-sparql-query-returns-wrong-results/42929378#42929378)
  * [p:](https://query.wikidata.org/#select%20%3Fitem%20%3Fseriesordinal%20%3Fauthoritem%20where%20%7B%0A%20%20%3Fitem%20p%3AP2093%20%3Fauthorstring%20.%0A%20%20%3Fitem%20p%3AP50%20%3Fauthoritem%20.%0A%20%20%3Fauthoritem%20pq%3AP1545%20%3Fseriesordinal%20.%0A%20%20%3Fauthorstring%20pq%3AP1545%20%3Fseriesordinal%20.%0A%7D) (as opposed to "wdt:")
    - explained [here](https://docs.google.com/presentation/d/e/2PACX-1vT6TxLmaz9jC5SkTVJsI2vMbtpKm1nQa2AQq8X0lOpTXThGZWuGjC5agoc0JwcRxwpg8CWWX5NLYfZN/pub?start=false&loop=false&delayms=3000#slide=id.g26f16af45e_0_1124) and [here](https://www.mediawiki.org/wiki/Wikibase/Indexing/RDF_Dump_Format#Predicates)
  * [ps:](https://www.wikidata.org/wiki/Wikidata:SPARQL_query_service/queries/examples#Number_of_handed_out_academy_awards_per_award_type)
    - [anderes Beispiel](https://query.wikidata.org/#DESCRIBE%20%3Chttp%3A%2F%2Fwww.wikidata.org%2Fentity%2Fstatement%2FQ45023480-0834E761-E3CD-4160-AA1A-3F26F8A1C2B5%3E)
  * [pq:](https://www.wikidata.org/wiki/Wikidata:SPARQL_query_service/queries/examples#Number_of_handed_out_academy_awards_per_award_type)
    - [additional example](https://query.wikidata.org/#%23Taxon%20authors%20with%20Wikidata%20items%20and%20a%20Wikispecies%20sitelink%0ASELECT%20DISTINCT%20%3Fauthor%20%3Fitem%20%0AWHERE%0A%7B%0A%09%3Fitem%20%09schema%3Aabout%20%3Fauthor%20%3B%0A%09%09%09schema%3AisPartOf%20%3Chttps%3A%2F%2Fspecies.wikimedia.org%2F%3E%20.%0A%20%20%20%20%3Ftaxon%20%20pq%3AP405%20%3Fauthor%20.%0A%7D%0ALIMIT%20100)
  * full list (seen in the [LDF results](https://query.wikidata.org/bigdata/ldf?predicate=http%3A%2F%2Fwww.wikidata.org%2Fprop%2Fdirect%2FP932&page=1) when accessed via curl)
    * xmlns:pr="http://www.wikidata.org/prop/reference/"
    * xmlns:prn="http://www.wikidata.org/prop/reference/value-normalized/"
    * xmlns:wdata="https://www.wikidata.org/wiki/Special:EntityData/"
    * xmlns:ps="http://www.wikidata.org/prop/statement/"
    * xmlns:wdref="http://www.wikidata.org/reference/"
    * xmlns:psn="http://www.wikidata.org/prop/statement/value-normalized/"
    * xmlns:wdno="http://www.wikidata.org/prop/novalue/"
    * xmlns:wdv="http://www.wikidata.org/value/"
    * xmlns:p="http://www.wikidata.org/prop/"
    * xmlns:psv="http://www.wikidata.org/prop/statement/value/"
    * xmlns:wdt="http://www.wikidata.org/prop/direct/"
    * xmlns:wd="http://www.wikidata.org/entity/"
    * xmlns:pqv="http://www.wikidata.org/prop/qualifier/value/"
    * xmlns:pq="http://www.wikidata.org/prop/qualifier/"
    * xmlns:wds="http://www.wikidata.org/entity/statement/"
    * xmlns:pqn="http://www.wikidata.org/prop/qualifier/value-normalized/"
    * xmlns:prv="http://www.wikidata.org/prop/reference/value/"
* [|](https://query.wikidata.org/#SELECT%20%3Fcity%20%3FcityLabel%20%28MAX%28%3Finhabitants%29%20AS%20%3Finhabitants%29%20WHERE%20%7B%0A%20%3Fcity%20%28p%3AP31%2Fps%3AP31%29%2Fwdt%3AP279%2a%20wd%3AQ1637706.%0A%20MINUS%20%7B%20%3Finhabitant%20ps%3AP19%7Cps%3AP551%7Cps%3AP20%20%3Fcity.%20%7D%0A%20OPTIONAL%20%7B%20%3Fcity%20wdt%3AP1082%20%3Finhabitants.%20%7D%0A%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22en%22.%20%7D%0A%7D%0AGROUP%20BY%20%3Fcity%20%3FcityLabel)
* [\*](https://query.wikidata.org/#SELECT%20%3Fcity%20%3FcityLabel%20%28MAX%28%3Finhabitants%29%20AS%20%3Finhabitants%29%20WHERE%20%7B%0A%20%3Fcity%20%28p%3AP31%2Fps%3AP31%29%2Fwdt%3AP279%2a%20wd%3AQ1637706.%0A%20MINUS%20%7B%20%3Finhabitant%20ps%3AP19%7Cps%3AP551%7Cps%3AP20%20%3Fcity.%20%7D%0A%20OPTIONAL%20%7B%20%3Fcity%20wdt%3AP1082%20%3Finhabitants.%20%7D%0A%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22en%22.%20%7D%0A%7D%0AGROUP%20BY%20%3Fcity%20%3FcityLabel)
* [/ (paths)](https://query.wikidata.org/#SELECT%20%3Fcity%20%3FcityLabel%20%28MAX%28%3Finhabitants%29%20AS%20%3Finhabitants%29%20WHERE%20%7B%0A%20%3Fcity%20%28p%3AP31%2Fps%3AP31%29%2Fwdt%3AP279%2a%20wd%3AQ1637706.%0A%20MINUS%20%7B%20%3Finhabitant%20ps%3AP19%7Cps%3AP551%7Cps%3AP20%20%3Fcity.%20%7D%0A%20OPTIONAL%20%7B%20%3Fcity%20wdt%3AP1082%20%3Finhabitants.%20%7D%0A%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22en%22.%20%7D%0A%7D%0AGROUP%20BY%20%3Fcity%20%3FcityLabel)
  - [some stats on Wikidata property path usage](http://kasei.us/archives/2018/09/28/wikidata_property_paths.html)
* [/ (division)](https://query.wikidata.org/#%23%20average%20scientific%20articles%20per%20publisher%0ASELECT%20%28%3FarticleCount%2F%3FpublisherCount%20AS%20%3FarticlesPerPublisher%29%20WITH%20%7B%0A%20%20SELECT%20%28COUNT%28%3Farticle%29%20AS%20%3FarticleCount%29%20WHERE%20%7B%0A%20%20%20%20%3Farticle%20wdt%3AP31%20wd%3AQ13442814.%0A%20%20%7D%0A%7D%20AS%20%25articleCount%20WITH%20%7B%0A%20%20SELECT%20%28COUNT%28%3Fpublisher%29%20AS%20%3FpublisherCount%29%20WHERE%20%7B%0A%20%20%20%20%3Fpublication%20wdt%3AP31%2Fwdt%3AP279%2a%20wd%3AQ5633421%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wdt%3AP123%20%3Fpublisher.%0A%20%20%7D%0A%7D%20AS%20%25publisherCount%20WHERE%20%7B%0A%20%20INCLUDE%20%25articleCount.%0A%20%20INCLUDE%20%25publisherCount.%0A%7D)
* [\[\]](https://query.wikidata.org/#SELECT%20%3Fcause%20%3FcauseLabel%20%28COUNT%28%3Fperson%29%20AS%20%3Fcount%29%0AWHERE%0A%7B%0A%20%20%3Fperson%20wdt%3AP31%20wd%3AQ5%3B%0A%20%20%20%20%20%20%20%20%20%20wdt%3AP509%20%3Fcause%3B%0A%20%20%20%20%20%20%20%20%20%20wdt%3AP53%20%5B%5D.%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22en%22.%20%7D%0A%7D%0AGROUP%20BY%20%3Fcause%20%3FcauseLabel%0AHAVING%28%3Fcount%20%3E%201%29%0AORDER%20BY%20DESC%28%3Fcount%29)
* [&&](https://query.wikidata.org/#SELECT%20%3Fcountry%20%3FcountryLabel%20%3Fpopulation%0A%28GROUP_CONCAT%28DISTINCT%20%3FcountryBLabel%20%3B%20separator%20%3D%20%22%2C%20%22%29%20AS%20%3FsimilarPopulation%29%0AWHERE%20%7B%0A%20%20%3Fcountry%20wdt%3AP31%20wd%3AQ6256%20.%0A%20%20%3Fcountry%20wdt%3AP1082%20%3Fpopulation%20.%0A%20%20%3FcountryB%20wdt%3AP31%20wd%3AQ6256%20.%0A%20%20%3FcountryB%20wdt%3AP1082%20%3FpopulationB%20.%0A%20%20FILTER%20%28%3Fcountry%20%21%3D%20%3FcountryB%20%26%26%20%3FpopulationB%20%3E%3D%20%3Fpopulation%20%2a%200.95%20%26%26%20%3FpopulationB%20%3C%3D%20%3Fpopulation%20%2a%201.05%29%0A%20%20%3Fcountry%20rdfs%3Alabel%20%3FcountryLabel%20.%20FILTER%20%28LANG%28%3FcountryLabel%29%20%3D%20%22en%22%29%20.%0A%20%20%3FcountryB%20rdfs%3Alabel%20%3FcountryBLabel%20.%20FILTER%20%28LANG%28%3FcountryBLabel%29%20%3D%20%22en%22%29%20.%0A%7D%0AGROUP%20BY%20%3Fcountry%20%3FcountryLabel%20%3Fpopulation%0AORDER%20BY%20%3FcountryLabel)
  - [another example](https://query.wikidata.org/#%23defaultView%3AImageGrid%0A%23Gallery%20of%20authors%20of%20scientific%20articles%20that%20have%20been%20published%20on%20this%20day%20of%20the%20year%0ASELECT%20DISTINCT%20%3Farticle%20%3FarticleLabel%20%3Fauthor%20%3FauthorLabel%20%3Fimage%20%28YEAR%28%3Fdate%29%20as%20%3Fyear%29%20%0AWHERE%0A%7B%0A%20%20%20%20BIND%28MONTH%28NOW%28%29%29%20AS%20%3FnowMonth%29%0A%20%20%20%20BIND%28DAY%28NOW%28%29%29%20AS%20%3FnowDay%29%0A%0A%20%20%20%20%3Farticle%20wdt%3AP31%20wd%3AQ13442814%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20wdt%3AP577%20%3Fdate%20.%0A%20%20%20%20FILTER%20%28MONTH%28%3Fdate%29%20%3D%20%3FnowMonth%20%26%26%20DAY%28%3Fdate%29%20%3D%20%3FnowDay%29.%0A%20%20%20%20%3Farticle%20wdt%3AP50%20%3Fauthor.%0A%20%20%20%20%3Fauthor%20wdt%3AP18%20%3Fimage%20.%0A%20%20%20%20SERVICE%20wikibase%3Alabel%20%7B%0A%20%20%20%20%20%20%20%20bd%3AserviceParam%20wikibase%3Alanguage%20%22en%22%20.%0A%20%20%20%20%7D%0A%7D%0AORDER%20BY%20ASC%28%3Fdate%29%0ALIMIT%201000)
* [^](https://query.wikidata.org/#SELECT%20%2a%20WHERE%20%7B%0A%20%20%3Fauthor%20wdt%3AP31%20wd%3AQ5%3B%0A%20%20%20%20%20%20%20%20%20%20%5Ewdt%3AP50%20%3FfirstPublication%2C%20%3FlastPublication.%0A%20%20FILTER%28%3Fauthor%20%21%3D%20wd%3AQ4233718%29%20%23%20%E2%80%9Canonymous%E2%80%9D%20is%20a%20human%2C%20apparently%E2%80%BD%0A%20%20%3FfirstPublication%20wdt%3AP577%20%3FfirstPublicationDate.%20hint%3APrior%20hint%3ArangeSafe%20true.%0A%20%20%3FlastPublication%20wdt%3AP577%20%3FlastPublicationDate.%20hint%3APrior%20hint%3ArangeSafe%20true.%0A%20%20FILTER%28%3FfirstPublicationDate%20%3C%20%221950-01-01%22%5E%5Exsd%3AdateTime%29%0A%20%20FILTER%28%3FfirstPublicationDate%20%3C%20%3FlastPublicationDate%29%0A%20%20FILTER%28%3FlastPublicationDate%20%3E%20%222010-01-01%22%5E%5Exsd%3AdateTime%29%0A%7D%0ALIMIT%20100)  
* [^^](https://query.wikidata.org/#SELECT%20%2a%20WHERE%20%7B%0A%20%20%3Fauthor%20wdt%3AP31%20wd%3AQ5%3B%0A%20%20%20%20%20%20%20%20%20%20%5Ewdt%3AP50%20%3FfirstPublication%2C%20%3FlastPublication.%0A%20%20FILTER%28%3Fauthor%20%21%3D%20wd%3AQ4233718%29%20%23%20%E2%80%9Canonymous%E2%80%9D%20is%20a%20human%2C%20apparently%E2%80%BD%0A%20%20%3FfirstPublication%20wdt%3AP577%20%3FfirstPublicationDate.%20hint%3APrior%20hint%3ArangeSafe%20true.%0A%20%20%3FlastPublication%20wdt%3AP577%20%3FlastPublicationDate.%20hint%3APrior%20hint%3ArangeSafe%20true.%0A%20%20FILTER%28%3FfirstPublicationDate%20%3C%20%221950-01-01%22%5E%5Exsd%3AdateTime%29%0A%20%20FILTER%28%3FfirstPublicationDate%20%3C%20%3FlastPublicationDate%29%0A%20%20FILTER%28%3FlastPublicationDate%20%3E%20%222010-01-01%22%5E%5Exsd%3AdateTime%29%0A%7D%0ALIMIT%20100)  
* [SAMPLE](https://query.wikidata.org/#%23defaultView%3ATable%0ASELECT%20%3Fwork%20%3FworkLabel%20(min(%3Fdates)%20as%20%3Fdate)%20(sample(%3Fpages_)%20as%20%3Fpages)%20(sample(%3Fvenue_labels)%20as%20%3Fvenue)%20(group_concat(%3Fauthor_label%3B%20separator%3D%22%2C%20%22)%20as%20%3Fauthors)%20WHERE%20{%0A%20%20%3Fwork%20wdt%3AP50%20wd%3AQ20895785%20.%0A%20%20%3Fwork%20wdt%3AP50%20%3Fauthor%20.%0A%20%20%3Fauthor%20rdfs%3Alabel%20%3Fauthor_label%20.%20filter%20(lang(%3Fauthor_label)%20%3D%20%27en%27)%0A%20%20%0A%20%20optional%20{%20%3Fwork%20wdt%3AP577%20%3Fdates%20}%0A%20%20optional%20{%20%3Fwork%20wdt%3AP1104%20%3Fpages_%20}%0A%20%20optional%20{%20%3Fwork%20wdt%3AP1433%20%3Fvenues%20.%20%3Fvenues%20rdfs%3Alabel%20%3Fvenue_labels%20.%20filter%20(lang(%3Fvenue_labels)%20%3D%20%27en%27)%20}%0A%20%20SERVICE%20wikibase%3Alabel%20{%20bd%3AserviceParam%20wikibase%3Alanguage%20%22en,fr,de,ru,es,zh,jp%22.%20}%20%20%0A}%20group%20by%20%3Fwork%20%3FworkLabel%0Aorder%20by%20desc(%3Fdate))
* [INCLUDE](https://query.wikidata.org/#%23Scholarly%20articles%20with%20Wikimedia%20sitelinks%0ASELECT%20%3Fpublication%20%3FpublicationLabel%20%3Fsitelinks%20WITH%20%7B%0A%20%20SELECT%20%3Fpublication%20%28COUNT%28%3Fsitelink%29%20as%20%3Fsitelinks%29%20WHERE%0A%20%20%7B%0A%20%20%20%20%3Fpublication%20wdt%3AP31%20wd%3AQ13442814%20.%20%23scientific%20articles%0A%20%20%20%20%7B%3Fsitelink%20schema%3Aabout%20%3Fpublication%20.%20%7D%20%23sitelinks%0A%20%20%7D%0A%20%20GROUP%20BY%20%3Fpublication%0A%7D%20AS%20%25results%20WHERE%20%7B%0A%20%20INCLUDE%20%25results.%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22en%22.%20%7D%0A%7D%0AORDER%20BY%20DESC%28%3Fsitelinks%29)
  - [background](https://wiki.blazegraph.com/wiki/index.php/NamedSubquery)
  - ["Using a named subquery to first find the results and only then add labels is a lot more efficient"](https://twitter.com/WikidataFacts/status/866912684285014016)
* [VALUES](https://query.wikidata.org/#%23Using%20VALUES%20for%20extracting%20scientific%20articles%20of%20specific%20authors%0A%23added%20before%202016-10%0A%0ASELECT%20%3Fentity%20%3Fdesc%20%3Fauthor%20WHERE%20%7B%0A%20%20VALUES%20%3Fwd_author%20%7Bwd%3AQ18016466%7D%20%23initialize%20%22%3Fwd_author%22%20with%20the%20Wikidata%20item%20%22Lydia%20Pintscher%22%20%20%0A%20%20%0A%20%20%3Fentity%20wdt%3AP31%20wd%3AQ13442814.%20%23filter%20by%20scientific%20articles%0A%20%20%3Fentity%20wdt%3AP50%20%3Fwd_author.%0A%20%20%0A%20%20%3Fwd_author%20rdfs%3Alabel%20%3Fauthor.%20%0A%20%20FILTER%28%28LANG%28%3Fauthor%29%29%20%3D%20%22en%22%29.%0A%20%20%0A%20%20%3Fentity%20rdfs%3Alabel%20%3Fdesc.%0A%20%20FILTER%28%28LANG%28%3Fdesc%29%29%20%3D%20%22en%22%29.%20%20%0A%7D)
  - [another example](https://query.wikidata.org/#%23defaultView%3ABubbleChart%0ASELECT%20DISTINCT%20%3Ftopic2%20%3Ftopic2Label%20%28COUNT%28DISTINCT%20%3Fwork2%29%20AS%20%3Fcount%29%20%23%3Fwork2%20%3Fwork2Label%20%23%3Fdate%20%0A%23%28GROUP_CONCAT%28DISTINCT%20%3Fauthor2Label%3B%20separator%3D%22%2C%20%22%29%20AS%20%3FauthorLabels%29%20%0A%23%28GROUP_CONCAT%28DISTINCT%20%3Ftopic2Label%3B%20separator%3D%22%2C%20%22%29%20AS%20%3FtopicLabels%29%20%0AWHERE%20%7B%0A%20%20%3Fwork%20wdt%3AP50%20wd%3AQ97270%20.%0A%20%20%3Fwork%20wdt%3AP50%20%3Fauthor1%20.%0A%20%20%3Fwork%20wdt%3AP50%20%3Fauthor2%20.%0A%20%20VALUES%20%3Fpublication_type%20%7B%20wd%3AQ13442814%20wd%3AQ571%20wd%3AQ26973022%7D%20%20%23%20journal%20and%20conference%20articles%2C%20books%2C%20not%20%28yet%3F%29%20software%0A%20%20%3Fwork2%20wdt%3AP31%20%3Fpublication_type%20%3B%0A%20%20%20%20%20%20%20%20%20wdt%3AP50%20%3Fauthor2%20%3B%0A%20%20%20%20%20%20%20%20%20wdt%3AP921%20%3Ftopic2%20.%0A%20%20MINUS%20%7B%20%3Fwork2%20wdt%3AP50%20wd%3AQ97270%20%7D%20.%0A%23%20%20OPTIONAL%20%7B%20%3Fwork2%20wdt%3AP921%20%3Ftopic2%20%7D%20.%0A%23%20%20%3Fauthor2%20rdfs%3Alabel%20%3Fauthor2Label%20.%20filter%20%28lang%28%3Fauthor2Label%29%20%3D%20%27en%27%29%0A%20%20%3Ftopic2%20rdfs%3Alabel%20%3Ftopic2Label%20.%20filter%20%28lang%28%3Ftopic2Label%29%20%3D%20%27en%27%29%0A%23%20%20%3Fwork2%20rdfs%3Alabel%20%3Fwork2Label%20.%20filter%20%28lang%28%3Fwork2Label%29%20%3D%20%27en%27%29%0A%7D%20GROUP%20BY%20%3Ftopic2%20%3Ftopic2Label%20%23%3Fwork2%20%3Fwork2Label%20%23%3Fdate%20%0AORDER%20BY%20DESC%20%28%3Fcount%29%0A%0A%23LIMIT%20200%0A)
  - [background](http://www.snee.com/bobdc.blog/2012/09/sparql-11s-new-values-keyword.html)
  - [my first attempt with VALUES](https://query.wikidata.org/#%23defaultView%3ATable%0A%23%20Publications%20citing%20papers%20from%20this%20page%0ASELECT%20%28min%28%3Fdates%29%20as%20%3Fdate%29%20%3Fwork%20%3FworkLabel%20WHERE%20%7B%0A%20%20VALUES%20%3Fwork1%20%7B%20wd%3AQ23307991%20wd%3AQ26822676%20wd%3AQ23332523%20wd%3AQ22035565%20wd%3AQ26277802%20wd%3AQ21132406%20wd%3AQ22066173%20wd%3AQ21679410%20wd%3AQ22341530%20wd%3AQ22032428%20wd%3AQ22067772%20wd%3AQ22122725%20wd%3AQ21092914%20wd%3AQ22001260%20wd%3AQ22065599%20wd%3AQ21195705%20wd%3AQ22273580%20wd%3AQ22067773%20wd%3AQ22001267%20wd%3AQ21032538%20wd%3AQ22000595%20wd%3AQ22273607%20wd%3AQ22121128%20wd%3AQ22021994%20wd%3AQ21092697%20wd%3AQ22273350%20wd%3AQ21146985%20wd%3AQ22063714%20wd%3AQ21090616%20wd%3AQ22251122%20wd%3AQ21092851%20wd%3AQ21265005%20wd%3AQ22036335%20wd%3AQ22001269%20wd%3AQ22034326%20wd%3AQ22305377%20wd%3AQ22341543%20wd%3AQ22341542%20wd%3AQ22341585%20wd%3AQ22341634%20wd%3AQ22665458%20wd%3AQ22667742%20wd%3AQ22667752%20wd%3AQ22680677%20wd%3AQ22695824%20wd%3AQ22695944%20wd%3AQ22696098%20wd%3AQ1192316%20wd%3AQ22810715%20wd%3AQ22813687%20wd%3AQ22923972%20wd%3AQ22939974%20wd%3AQ22939969%20wd%3AQ22939970%20wd%3AQ22952272%20wd%3AQ22978859%20wd%3AQ22979221%20wd%3AQ22979317%20wd%3AQ22979324%20wd%3AQ22997956%20wd%3AQ22998480%20wd%3AQ22914690%20wd%3AQ23008981%20wd%3AQ23009110%20wd%3AQ23011530%20wd%3AQ23021109%20wd%3AQ23042247%20wd%3AQ23042260%20wd%3AQ23048188%20wd%3AQ23052128%20wd%3AQ21558505%20wd%3AQ23054968%20wd%3AQ23058134%20wd%3AQ23302003%20wd%3AQ23308142%20wd%3AQ23308157%20wd%3AQ23308159%20wd%3AQ23308174%20wd%3AQ23308192%20wd%3AQ23308194%20wd%3AQ23308196%20wd%3AQ23328810%20wd%3AQ23329370%20wd%3AQ23329499%20wd%3AQ23331292%20wd%3AQ23331230%20wd%3AQ23671823%20wd%3AQ23747506%20wd%3AQ23747515%20wd%3AQ23747500%20wd%3AQ23757022%20wd%3AQ23763787%20wd%3AQ24035234%20wd%3AQ24028460%20wd%3AQ24048898%20wd%3AQ24048799%20wd%3AQ24048935%20wd%3AQ24040334%20wd%3AQ24048946%20wd%3AQ24048988%20wd%3AQ24049114%20wd%3AQ24049252%20wd%3AQ24049922%20wd%3AQ24049929%20wd%3AQ24050018%20wd%3AQ24050082%20wd%3AQ24050084%20wd%3AQ24052504%20wd%3AQ24054594%20wd%3AQ24083038%20wd%3AQ24083039%20wd%3AQ24090615%20wd%3AQ24091290%20wd%3AQ21534937%20wd%3AQ24205728%20wd%3AQ23327424%20wd%3AQ1362699%20wd%3AQ7310435%20wd%3AQ24264066%20wd%3AQ24271128%20wd%3AQ24273087%20wd%3AQ24255006%20wd%3AQ24273293%20wd%3AQ24273359%20wd%3AQ24273366%20wd%3AQ24276690%20wd%3AQ24276671%20wd%3AQ24276928%20wd%3AQ24261087%20wd%3AQ24279166%20wd%3AQ24282611%20wd%3AQ24282586%20wd%3AQ24282583%20wd%3AQ24282589%20wd%3AQ24282580%20wd%3AQ24282579%20wd%3AQ22250901%20wd%3AQ21709334%20wd%3AQ22066340%20wd%3AQ24290620%20wd%3AQ24261410%20wd%3AQ1138394%20wd%3AQ24456433%20wd%3AQ24492476%20wd%3AQ24492861%20wd%3AQ24494900%20wd%3AQ24514431%20wd%3AQ24515682%20wd%3AQ24521666%20%7D%0A%20%20%3Fwork%20wdt%3AP2860%20%3Fwork1%20.%0A%20%20optional%20%7B%20%3Fwork%20wdt%3AP577%20%3Fdates%20.%20%7D%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%0A%20%20%20%20bd%3AserviceParam%20wikibase%3Alanguage%20%22en%2Cfr%2Cde%2Cru%2Ces%2Czh%2Cjp%22.%0A%20%20%7D%0A%7D%0Agroup%20by%20%3Fwork%20%3FworkLabel%0Aorder%20by%20desc%28%3Fdate%29%0ALIMIT%201000)
  - VALUES can take more than one argument ([example](https://stackoverflow.com/a/17678363/446855))
* [HAVING](http://stackoverflow.com/questions/36553600/sparql-limit-the-result-for-each-value-of-a-varible)
  - [HAVING vs FILTER](https://twitter.com/WikidataFacts/status/1016813974136946688)
* [BIND](https://query.wikidata.org/#SELECT%20%3FstationA%20%3FstationALabel%20%3FstationB%20%3FstationBLabel%20%3Fslope%20%3FaltA%20%3FaltB%20%3FcoordA%20%3FcoordB%20%3Fdiff%20%3Fdist%0AWHERE%0A%7B%0A%09%3FstationA%20wdt%3AP197%20%3FstationB%20.%0A%09%3FstationA%20wdt%3AP2044%20%3FaltA%20%3B%20wdt%3AP625%20%3FcoordA%20.%0A%09%3FstationB%20wdt%3AP2044%20%3FaltB%20%3B%20wdt%3AP625%20%3FcoordB%20.%0A%09BIND%28%20geof%3Adistance%28%20%3FcoordA%20%2C%20%3FcoordB%29%20as%20%3Fdist%20%29%20.%0A%09BIND%28%20%28%3FaltA%20-%20%3FaltB%29%20as%20%3Fdiff%20%29%0A%09BIND%28%20%28%3Fdiff%20%2F%20%3Fdist%29%20as%20%3Fslope%20%29%0A%09SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22fr%2Cen%22%20%7D%0A%7D%20order%20by%20desc%28%3Fslope%29)
  - [another example](https://query.wikidata.org/#SELECT%20%3Fitem%20%3FitemLabel%20%3Fid%20%3Furl%20WHERE%20%7B%20%0A%20%20wd%3AP3827%20wdt%3AP1630%20%3Fformatterurl%20.%0A%20%20%3Fitem%20wdt%3AP3827%20%3Fid%20%0A%20%20BIND%28IRI%28REPLACE%28%3Fid%2C%20%27%5E%28.%2B%29%24%27%2C%20%3Fformatterurl%29%29%20AS%20%3Furl%29%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22en%22%20.%20%7D%0A%20%20%7D%0A%20%20%20%20%20%20%20%20)
* [LABEL](https://lists.wikimedia.org/pipermail/wikidata/2017-April/010508.html)  
  - [sample query](https://query.wikidata.org/#SELECT%20%20%3F_Geburtsdatum%20%20WHERE%20%7B%0A%20%20%3Fs%20%3Flabel%20%22Brian%20O%27Nolan%22%40en.%0A%20%20OPTIONAL%20%7B%20%3Fs%20wdt%3AP569%20%3F_Geburtsdatum.%20%7D%0A%7D)
* [!](https://twitter.com/WikidataFacts/status/866083538206150660) (negation)
* [difference between MINUS and FILTER NOT EXISTS](https://twitter.com/WikidataFacts/status/866081916600152064)
* [wikibase:mwapi](http://tinyurl.com/ycl6gu73)
- wdv, wdn
- federated queries
  - Wikidata and DBpedia
    - [Universities ranked by page rank](http://tinyurl.com/yc3eh4p4) ([source](https://twitter.com/thalhamm/status/902624787071164425); [variant](https://twitter.com/kidehen/status/902637011294707712))
  - [combination of SPARQL with Elastic](https://query.wikidata.org/#SELECT%20%3Fitem%20%20%28COUNT%28%3Fsitelink%29%20AS%20%3Fsites%29%20WHERE%20%7B%0A%20%20SERVICE%20wikibase%3Amwapi%20%7B%0A%20%20%20%20%20%20bd%3AserviceParam%20wikibase%3Aapi%20%22EntitySearch%22%20.%0A%20%20%20%20%20%20bd%3AserviceParam%20wikibase%3Aendpoint%20%22www.wikidata.org%22%20.%0A%20%20%20%20%20%20bd%3AserviceParam%20mwapi%3Asearch%20%22%E5%9B%9B%E5%B7%9D%22%20.%0A%20%20%20%20%20%20bd%3AserviceParam%20mwapi%3Alanguage%20%22zh%22%20.%0A%20%20%20%20%20%20%3Fitem%20wikibase%3AapiOutputItem%20mwapi%3Aitem%0A%20%20%7D%0A%20%20%3Fsitelink%20schema%3Aabout%20%3Fitem%0AMINUS%20%7B%3Fitem%20wdt%3AP31%20wd%3AQ4167410%7D%0A%7D%20GROUP%20BY%20%3Fitem%20ORDER%20BY%20DESC%28%3Fsites%29%20LIMIT%201)  
- [OFFSET](https://query.wikidata.org/#SELECT%20%3Farticle%20%3Ftitle%0AWITH%20{%0A%20SELECT%20%3Farticle%20%3Ftitle%0A%20WHERE%20{%0A%20%3Farticle%20wdt%3AP31%20wd%3AQ13442814%20%3B%0A%20wdt%3AP1476%20%3Ftitle%20.%0A%20}%20LIMIT%20500000%20OFFSET%200%0A}%20AS%20%25RESULTS%20{%0A%20INCLUDE%20%25RESULTS%0A%20FILTER%20(CONTAINS(LCASE(%3Ftitle)%2C%20"caffeine"))%0A}) 
- [DROP](https://wiki.blazegraph.com/wiki/index.php/SPARQL_Update#DROP_SOLUTIONS)
- [COALESCE](https://twitter.com/WikidataFacts/status/924361383919136773)
  - [another one](https://twitter.com/WikidataFacts/status/936545295692894208)
  - [one more](https://twitter.com/generalising/status/1091721992028459008) &mdash; see also the mention of loops later in that thread
  - [yet another one](https://twitter.com/fnielsen/status/1095851442815012864)
- [wikibase:sitelinks](http://tinyurl.com/y7ssp2gt)
- [wikibase:identifiers](http://tinyurl.com/y7ssp2gt)
- [DESCRIBE](https://query.wikidata.org/#DESCRIBE%20%3Chttp%3A%2F%2Fwww.wikidata.org%2Fentity%2Fstatement%2FQ45023480-0834E761-E3CD-4160-AA1A-3F26F8A1C2B5%3E)
- [Map layer](https://query.wikidata.org/#%23defaultView%3AMap%7B%22layer%22%3A%22%3Fplace%22%7D%0ASELECT%20DISTINCT%20%3Fperson%20%3FpersonLabel%20%3Fplace%20%3FplaceLabel%20%3Fcoord%20%0AWITH%20%7B%0A%20%20SELECT%20%3Fperson%20%3Fplace%20%3Fcoord%20WHERE%20%7B%0A%20%20%3Fperson%20wdt%3AP19%20%3Fplace%20%3B%0A%20%20%20%20%20%20%20%20%20%20wdt%3AP496%20%3Forcid%20.%0A%20%20%3Fplace%20wdt%3AP625%20%3Fcoord%20.%0A%20%7D%20%20%0A%7D%20AS%20%25results%0AWHERE%20%7B%0A%20%20INCLUDE%20%25results%20%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22%5BAUTO_LANGUAGE%5D%2Cen%22.%20%7D%0A%7D)
  - another example: [mountains in Switzerland, by height category](https://query.wikidata.org/#SELECT%20%3Fitem%20%3FitemLabel%20%3Fcoord%20%3Fheight%20%3Flayer%20%3Fimage%20%0AWHERE%20%7B%20%3Fitem%20wdt%3AP31%20wd%3AQ8502.%20%0A%20%20%20%20%20%20%20%3Fitem%20wdt%3AP625%20%3Fcoord.%20%0A%20%20%20%20%20%20%20%3Fitem%20wdt%3AP17%20wd%3AQ39.%20%20%0A%20%20%20%20%20%20%20%3Fitem%20wdt%3AP2044%20%3Fheight%20.%20%0A%20%20%20%20%20%20%20BIND%28%20%0A%20%20%20%20%20%20%20%20%20IF%28%3Fheight%20%3C%201000%2C%20%22%3C1000%20metres%22%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20IF%28%3Fheight%20%3C%202000%2C%20%221000%20-%202000%20metres%22%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20IF%28%3Fheight%20%3C%203000%2C%20%222000%20-%203000%20metres%22%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20IF%28%3Fheight%20%3C%204000%2C%20%223000%20-%204000%20metres%22%2C%20%22%3E%204000%20metres%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%29%0A%20%20%20%20%20%20%20%20%20%20%20%29%20AS%20%3Flayer%29.%20%0A%20%20%20%20%20%20%20OPTIONAL%20%7B%3Fitem%20wdt%3AP18%20%3Fimage.%7D%20%0A%20%20%20%20%20%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22%5BAUTO_LANGUAGE%5D%2Cen%22.%20%7D%20%0A%20%20%20%20%20%20%7D) &mdash; via [this presentation](https://twitter.com/csarasuagar/status/1048289434880364545)
- PREFIX
  - [renewcommand-style usage](https://query.wikidata.org/#PREFIX%20isA%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Chttp%3A%2F%2Fwww.wikidata.org%2Fprop%2Fdirect%2FP31%3E%0APREFIX%20hasAuthor%3A%20%20%20%20%20%20%20%20%3Chttp%3A%2F%2Fwww.wikidata.org%2Fprop%2Fdirect%2FP50%3E%0APREFIX%20hasGender%3A%20%20%20%20%20%20%20%20%3Chttp%3A%2F%2Fwww.wikidata.org%2Fprop%2Fdirect%2FP21%3E%0APREFIX%20scholarlyArticle%3A%20%3Chttp%3A%2F%2Fwww.wikidata.org%2Fentity%2FQ13442814%3E%0APREFIX%20female%3A%20%20%20%20%20%20%20%20%20%20%20%3Chttp%3A%2F%2Fwww.wikidata.org%2Fentity%2FQ6581072%3E%0A%0ASELECT%20%3Farticle%20%3FarticleLabel%20%3Fauthor%20%3FauthorLabel%20WITH%20%7B%0A%20%20SELECT%20%3Fauthor%20WHERE%20%7B%0A%20%20%20%20%3Fauthor%20hasGender%3A%20female%3A%20.%0A%20%20%7D%20LIMIT%20250000%20OFFSET%200%0A%7D%20AS%20%25authors%20WITH%20%7B%0A%20%20SELECT%20%3Fauthor%20%3Farticle%20WHERE%20%7B%0A%20%20%20%20INCLUDE%20%25authors%0A%20%20%20%20%3Farticle%20isA%3A%20scholarlyArticle%3A%20%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20hasAuthor%3A%20%3Fauthor%20.%0A%20%20%7D%20LIMIT%20500000%20OFFSET%200%0A%7D%20AS%20%25articles%20WHERE%20%7B%0A%20%20INCLUDE%20%25articles%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22%5BAUTO_LANGUAGE%5D%2Cen%22.%20%7D%0A%7D)
- [xsd:decimal](https://stackoverflow.com/questions/49012872/duplicated-results-from-wikidata) (seen [here](https://twitter.com/piecesofuk/status/994960638358278145))
- [xsd:integer](https://query.wikidata.org/#SELECT%20%3FrfcId%20%3FitemLabel%20%3FclassLabel%20%3Fitem%0AWHERE%20%0A%7B%0A%20%20%3Fitem%20wdt%3AP31%20%3Fclass.%0A%20%20%3Fitem%20wdt%3AP892%20%3FrfcId.%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22%5BAUTO_LANGUAGE%5D%2Cen%22.%20%7D%0A%7D%0AORDER%20BY%20xsd%3Ainteger%28%3FrfcId%29%0A) for ordering results numerically (seen [here](https://opendata.stackexchange.com/a/13042/1857))
* [GROUP_CONCAT](https://query.wikidata.org/embed.html#SELECT%20%3Fwinner%20%3FwinnerLabel%20%28COUNT%28%2a%29%20AS%20%3Fcount%29%20%28GROUP_CONCAT%28%3Fyear%29%20AS%20%3Fyears%29%0AWHERE%20%7B%0A%20%20%3Fitem%20wdt%3AP3450%20wd%3AQ19317%20%3B%20wdt%3AP582%20%3Fdate%20%3B%20wdt%3AP1346%2Fwdt%3AP1532%20%3Fwinner%20.%0A%20%20BIND%28YEAR%28%3Fdate%29%20AS%20%3Fyear%29%20.%0A%20%20FILTER%20%28%3Fyear%20%3C%3D%202018%29%20.%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22%5BAUTO_LANGUAGE%5D%2Cen%22%20.%20%7D%0A%7D%0AGROUP%20BY%20%3Fwinner%20%3FwinnerLabel%0AORDER%20BY%20DESC%28%3Fcount%29%20%3Fyears)
* [CONCAT](https://query.wikidata.org/#SELECT%20%3FBibliothek%20%3FBibliothekLabel%20%20%3FStaatLabel%20%3FTwitter_Benutzername%20%28URI%28CONCAT%28%27https%3A%2F%2Ftwitter.com%2F%27%2CSTR%28%3FTwitter_Benutzername%29%29%29%20AS%20%3FTwitterURI%29%20WITH%20%20%7B%0A%20%20%0A%20%20SELECT%20DISTINCT%20%3FStaat%20WHERE%20%7B%0A%20%20%3FStaat%20wdt%3AP463%20wd%3AQ458.%0A%20%20%20%7D%20%7D%20as%20%25eu%0A%20%20WHERE%20%7Binclude%20%25eu%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22%5BAUTO_LANGUAGE%5D%2Cen%22.%20%7D%0A%20%20%0A%20%20%3FBibliothek%20%28wdt%3AP31%2Fwdt%3AP279%2a%29%20wd%3AQ7075.%0A%20%20%3FBibliothek%20wdt%3AP17%20%3FStaat.%0A%20%20%3FBibliothek%20wdt%3AP2002%20%3FTwitter_Benutzername.%0A%0A%7D%0AORDER%20BY%20%3FStaatLabel) (seen [here](https://twitter.com/LibrErli/status/1021748008856297472))
* [URI](https://query.wikidata.org/#SELECT%20%3FBibliothek%20%3FBibliothekLabel%20%20%3FStaatLabel%20%3FTwitter_Benutzername%20%28URI%28CONCAT%28%27https%3A%2F%2Ftwitter.com%2F%27%2CSTR%28%3FTwitter_Benutzername%29%29%29%20AS%20%3FTwitterURI%29%20WITH%20%20%7B%0A%20%20%0A%20%20SELECT%20DISTINCT%20%3FStaat%20WHERE%20%7B%0A%20%20%3FStaat%20wdt%3AP463%20wd%3AQ458.%0A%20%20%20%7D%20%7D%20as%20%25eu%0A%20%20WHERE%20%7Binclude%20%25eu%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22%5BAUTO_LANGUAGE%5D%2Cen%22.%20%7D%0A%20%20%0A%20%20%3FBibliothek%20%28wdt%3AP31%2Fwdt%3AP279%2a%29%20wd%3AQ7075.%0A%20%20%3FBibliothek%20wdt%3AP17%20%3FStaat.%0A%20%20%3FBibliothek%20wdt%3AP2002%20%3FTwitter_Benutzername.%0A%0A%7D%0AORDER%20BY%20%3FStaatLabel) (seen [here](https://twitter.com/LibrErli/status/1021748008856297472))
* [HINT](https://wiki.blazegraph.com/wiki/index.php/QueryHints)
  - [example](https://query.wikidata.org/#SELECT%20%2a%20WHERE%20%7B%0A%20%20%3Fauthor%20wdt%3AP31%20wd%3AQ5%3B%0A%20%20%20%20%20%20%20%20%20%20%5Ewdt%3AP50%20%3FfirstPublication%2C%20%3FlastPublication.%0A%20%20FILTER%28%3Fauthor%20%21%3D%20wd%3AQ4233718%29%20%23%20%E2%80%9Canonymous%E2%80%9D%20is%20a%20human%2C%20apparently%E2%80%BD%0A%20%20%3FfirstPublication%20wdt%3AP577%20%3FfirstPublicationDate.%20hint%3APrior%20hint%3ArangeSafe%20true.%0A%20%20%3FlastPublication%20wdt%3AP577%20%3FlastPublicationDate.%20hint%3APrior%20hint%3ArangeSafe%20true.%0A%20%20FILTER%28%3FfirstPublicationDate%20%3C%20%221950-01-01%22%5E%5Exsd%3AdateTime%29%0A%20%20FILTER%28%3FfirstPublicationDate%20%3C%20%3FlastPublicationDate%29%0A%20%20FILTER%28%3FlastPublicationDate%20%3E%20%222010-01-01%22%5E%5Exsd%3AdateTime%29%0A%7D%0ALIMIT%20100)  
  - [another example](https://query.wikidata.org/#SELECT%20%2a%20WHERE%20%7B%0A%20%20%3Fauthor%20wdt%3AP31%20wd%3AQ5%3B%0A%20%20%20%20%20%20%20%20%20%20%5Ewdt%3AP50%20%3FfirstPublication%2C%20%3FlastPublication.%0A%20%20FILTER%28%3Fauthor%20%21%3D%20wd%3AQ4233718%29%20%23%20%E2%80%9Canonymous%E2%80%9D%20is%20a%20human%2C%20apparently%E2%80%BD%0A%20%20%3FfirstPublication%20wdt%3AP577%20%3FfirstPublicationDate.%20hint%3APrior%20hint%3ArangeSafe%20true.%0A%20%20%3FlastPublication%20wdt%3AP577%20%3FlastPublicationDate.%20hint%3APrior%20hint%3ArangeSafe%20true.%0A%20%20FILTER%28%3FfirstPublicationDate%20%3C%20%221950-01-01%22%5E%5Exsd%3AdateTime%29%0A%20%20FILTER%28%3FfirstPublicationDate%20%3C%20%3FlastPublicationDate%29%0A%20%20FILTER%28%3FlastPublicationDate%20%3E%20%222010-01-01%22%5E%5Exsd%3AdateTime%29%0A%7D%0ALIMIT%20100)  
  - [one more](https://query.wikidata.org/#SELECT%20%3Fstate%20%3FstateLabel%20%3Fcapital%20%3FcapitalLabel%20WHERE%20%7B%0A%20%20%3Fstate%20wdt%3AP31%2Fwdt%3AP279%2a%20wd%3AQ3624078%3B%0A%20%20%20%20%20%20%20%20%20wdt%3AP36%20%3Fcapital.%0A%23%20%20MINUS%20%7B%20%3Fstate%20wdt%3AP576%7Cwdt%3AP582%20%3Fend.%20%7D%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%0A%20%20%20%20bd%3AserviceParam%20wikibase%3Alanguage%20%22en%22.%0A%20%20%20%20%3Fstate%20rdfs%3Alabel%20%3FstateLabel.%0A%20%20%20%20%3Fcapital%20rdfs%3Alabel%20%3FcapitalLabel.%0A%20%20%7D%20hint%3APrior%20hint%3ArunLast%20false.%0A%20%20BIND%28CONCAT%28%22%5E%5B%22%2C%20%3FstateLabel%2C%20%22%5D%2a%24%22%29%20AS%20%3Fregex%29%0A%20%20FILTER%28REGEX%28%3FcapitalLabel%2C%20%3Fregex%2C%20%22i%22%29%29%0A%20%20MINUS%20%7B%20%3Fcapital%20wdt%3AP138%20%3Fstate.%20%7D%0A%7D)
* [REGEX](https://query.wikidata.org/#SELECT%20%3Fstate%20%3FstateLabel%20%3Fcapital%20%3FcapitalLabel%20WHERE%20%7B%0A%20%20%3Fstate%20wdt%3AP31%2Fwdt%3AP279%2a%20wd%3AQ3624078%3B%0A%20%20%20%20%20%20%20%20%20wdt%3AP36%20%3Fcapital.%0A%23%20%20MINUS%20%7B%20%3Fstate%20wdt%3AP576%7Cwdt%3AP582%20%3Fend.%20%7D%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%0A%20%20%20%20bd%3AserviceParam%20wikibase%3Alanguage%20%22en%22.%0A%20%20%20%20%3Fstate%20rdfs%3Alabel%20%3FstateLabel.%0A%20%20%20%20%3Fcapital%20rdfs%3Alabel%20%3FcapitalLabel.%0A%20%20%7D%20hint%3APrior%20hint%3ArunLast%20false.%0A%20%20BIND%28CONCAT%28%22%5E%5B%22%2C%20%3FstateLabel%2C%20%22%5D%2a%24%22%29%20AS%20%3Fregex%29%0A%20%20FILTER%28REGEX%28%3FcapitalLabel%2C%20%3Fregex%2C%20%22i%22%29%29%0A%20%20MINUS%20%7B%20%3Fcapital%20wdt%3AP138%20%3Fstate.%20%7D%0A%7D)  
* [ISBLANK](https://www.wikidata.org/w/index.php?title=Wikidata:Request_a_query&oldid=733581432#Award_winning_women_with_no_article_a_or_no_language)
* [STRAFTER](https://query.wikidata.org/#SELECT%20%3Fitem%20%3Fsitelinks%20%3Fidentifiers%0AWITH%20%7B%0A%20%20SELECT%20%3Fitem%20WHERE%20%7B%0A%20%20%20%20VALUES%20%3Fgametype%20%7B%0A%20%20%20%20%20%20wd%3AQ7889%0A%20%20%20%20%20%20wd%3AQ16070115%0A%20%20%20%20%20%20wd%3AQ705867%0A%20%20%20%20%7D%0A%20%20%20%20%3Fitem%20wdt%3AP31%20%3Fgametype.%0A%20%20%20%20BIND%28xsd%3Ainteger%28STRAFTER%28str%28%3Fitem%29%2C%20%22Q%22%29%29%20AS%20%3Fqid%29%0A%20%20%20%20FILTER%28%3Fqid%20%3E%2055000000%29%0A%20%20%7D%0A%20%20ORDER%20BY%20DESC%28%3Fqid%29%0A%20%20LIMIT%2050%0A%7D%20AS%20%25items%0AWITH%20%7B%0A%20%20SELECT%20%3Fitem%20%28GROUP_CONCAT%28%3Fsitelink%29%20as%20%3Fsitelinks%29%20WHERE%20%7B%0A%20%20%20%20INCLUDE%20%25items.%0A%20%20%20%20OPTIONAL%20%7B%20%0A%20%20%20%20%20%20%3Farticle%20a%20schema%3AArticle%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20schema%3Aabout%20%3Fitem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20schema%3AinLanguage%20%3Flanguage.%20%0A%20%20%20%20%20%20BIND%28CONCAT%28%22%5B%22%2C%20STR%28%3Farticle%29%2C%20%22%20%22%2C%20%3Flanguage%2C%20%22%5D%22%29%20AS%20%3Fsitelink%29%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20GROUP%20BY%20%3Fitem%0A%7D%20AS%20%25itemsWithSitelinks%0AWITH%20%7B%0A%20%20SELECT%20%3Fitem%20%28GROUP_CONCAT%28%3Fidentifier%29%20as%20%3Fidentifiers%29%20WHERE%20%7B%0A%20%20%20%20INCLUDE%20%25items.%0A%20%20%20%20OPTIONAL%20%7B%0A%20%20%20%20%20%20%3Fproperty%20a%20wikibase%3AProperty%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wdt%3AP31%2Fwdt%3AP279%2a%20wd%3AQ28147643%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wikibase%3ApropertyType%20wikibase%3AExternalId%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wdt%3AP1630%20%3FformatterUrl%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wikibase%3AdirectClaim%20%3Fwdt%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20rdfs%3Alabel%20%3FpropertyLabel.%0A%20%20%20%20%20%20FILTER%28LANG%28%3FpropertyLabel%29%20%3D%20%22en%22%29%0A%20%20%20%20%20%20%3Fitem%20%3Fwdt%20%3Fid.%0A%20%20%20%20%20%20BIND%28IRI%28REPLACE%28%3Fid%2C%20%27%5E%28.%2B%29%24%27%2C%20%3FformatterUrl%29%29%20AS%20%3Furl%29%0A%20%20%20%20%20%20BIND%28CONCAT%28%22%5B%22%2C%20STR%28%3Furl%29%2C%20%22%20%22%2C%20%3FpropertyLabel%2C%20%22%5D%22%29%20AS%20%3Fidentifier%29%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20GROUP%20BY%20%3Fitem%0A%7D%20AS%20%25itemsWithExternalIdentifiers%0AWHERE%20%7B%0A%20%20INCLUDE%20%25itemsWithSitelinks.%0A%20%20INCLUDE%20%25itemsWithExternalIdentifiers.%0A%7D) ([source](https://twitter.com/WikidataFacts/status/1038084838773927938))
  - also shows a simple way to get a QID
* ordering of commands
  - [different results depending on position of an OPTIONAL clause](https://twitter.com/WikidataFacts/status/1047954011700252672)

## SPARQL queries that did not work for me (at least not as expected)

* there is a [dedicated page for these](https://www.wikidata.org/wiki/Wikidata:SPARQL_query_service/suggestions)
* [duplicate series ordinal (P1545) for author string (P2093) statements](https://query.wikidata.org/#select%20%3Fitem%20%3Fseriesordinal%20where%20%7B%0A%20%20%3Fitem%20p%3AP50%20%3Fauthorstring%20%3B%0A%20%20%20%20%20%20%20%20p%3AP50%20%3Fauthorstring2%20.%0A%20%20%3Fauthorstring%20pq%3AP1545%20%3Fseriesordinal%20.%0A%20%20%3Fauthorstring2%20pq%3AP1545%20%3Fseriesordinal%20.%0A%7D)
  - [a similar query, with similar issues](https://query.wikidata.org/#select%20%3Fitem%20%3Fseriesordinal%20%3Fauthoritem%20where%20%7B%0A%20%20%3Fitem%20p%3AP2093%20%3Fauthorstring%20.%0A%20%20%3Fitem%20p%3AP50%20%3Fauthoritem%20.%0A%20%20%3Fauthoritem%20pq%3AP1545%20%3Fseriesordinal%20.%0A%20%20%3Fauthorstring%20pq%3AP1545%20%3Fseriesordinal%20.%0A%7D)

## SPARQL query optimization

* some pointers [here](https://www.wikidata.org/wiki/Wikidata:SPARQL_query_service/query_optimization)

# SPARQL endpoints

- [What is a SPARQL Endpoint, and why is it important?](https://medium.com/virtuoso-blog/what-is-a-sparql-endpoint-and-why-is-it-important-b3c9e6a20a8b)
- relatively complete list at https://www.w3.org/wiki/SparqlEndpoints
- examples
  * http://query.wikidata.org/
    - [some non-SPARQL magic keys](https://twitter.com/WikidataFacts/status/1063429813350871040)
    - [how to query the  Wikidata SPARQL endpoint for edit versions/ commit history](https://query.wikidata.org/#SELECT%20%2a%20%7B%0A%20%20%3Fitem%20wdt%3AP31%20wd%3AQ3839507.%0A%20%20BIND%28replace%28STR%28%3Fitem%29%2C%20%22http%3A%2F%2Fwww.wikidata.org%2Fentity%2F%22%2C%20%22%22%29%20as%20%3Ftitle%29%0A%20%20%20%20%20SERVICE%20wikibase%3Amwapi%20%7B%0A%20%20%20%20%20%20bd%3AserviceParam%20wikibase%3Aendpoint%20%22www.wikidata.org%22%20.%0A%20%20%20%20%20%20bd%3AserviceParam%20wikibase%3Aapi%20%22Generator%22%20.%0A%20%20%20%20%20%20bd%3AserviceParam%20mwapi%3Agenerator%20%22revisions%22%20.%0A%20%20%20%20%20%20bd%3AserviceParam%20mwapi%3Atitles%20%3Ftitle%20.%0A%20%20%20%20%20%20bd%3AserviceParam%20mwapi%3Agrvprop%20%22timestamp%7Ccomment%7Cuserid%22%20.%0A%20%20%20%20%20%20bd%3AserviceParam%20mwapi%3Agrvlimit%20%221000%22.%0A%20%20%20%20%20%20bd%3AserviceParam%20mwapi%3Aprop%20%20%22revisions%22.%0A%20%20%20%20%20%20%3Fcomment%20wikibase%3AapiOutput%20%22revisions%2Frev%5B1%5D%2F%40comment%22.%0A%20%20%20%20%20%20%3Fuser%20wikibase%3AapiOutput%20%22revisions%2Frev%5B1%5D%2F%40user%22.%0A%20%20%20%20%7D%0A%20%20FILTER%28contains%28lcase%28%3Fcomment%29%2C%20%22create%22%29%20%26%26%20contains%28%3Fuser%2C%20%22bot%22%29%29%0A%20%20%7D%0ALIMIT%20100) &mdash; some basic explanations in [this tweet](https://twitter.com/jsamwrites/status/1060534471605342208)
  * https://hhs.github.io/meshrdf/sample-queries.html
- [Differences between SPARQL implementations](https://twitter.com/jjmhtp/status/1007415531526348800)
- [City of Zurich](https://ld.stadt-zuerich.ch/sparql/#) ([background](https://www.liip.ch/en/blog/best-of-both-worlds-catalogue-for-linked-open-data-lod))

# SPARQL via the command line

- curl -H "Accept:text/csv" --data-urlencode "query=SELECT (<https://example.com/a,b > AS ?result) WHERE {}" https://query.wikidata.org/sparql
  - seen [here](https://twitter.com/jindrichmynarz/status/1020319524820791298)
- curl --data-urlencode "query@subtreeClasses.rq" https://query.wikidata.org/sparql -H "Accept: text/turtle"  > chemicalElementSubClasses.ttl
  - assumes a WDQS query in subtreeClasses.rq; seen [here](http://www.snee.com/bobdc.blog/2018/11/extracting-rdf-data-models-fro.html)
  - see also https://twitter.com/Ettore_Rizza/status/1064428103068467200 for wdtaxonomy tool version of the same visualization
- curl https://wdhqs.wmflabs.org/sparql -X POST --data 'query=%23+Number+of+Wikidata+users+who+have+added+or+removed+wd%3AP50+(author)+statements%0A%0APREFIX+schema%3A+%3Chttp%3A%2F%2Fschema.org%2F%3E%0APREFIX+hist%3A+%3Chttp%3A%2F%2Fwikiba.se%2Fhistory%2Fontology%23%3E%0APREFIX+wdt%3A+%3Chttp%3A%2F%2Fwww.wikidata.org%2Fprop%2Fdirect%2F%3E%0A%0ASELECT+(COUNT(DISTINCT+%3Fuser)+AS+%3Fcount)+WHERE+%7B%0A++GRAPH+%3FaddOrDel+%7B%0A++++%3Fitem+wdt%3AP50+%3Fvalue+.%0A++%7D%0A++%3Frev+hist%3Aadditions%7Chist%3Adeletions+%3FaddOrDel+%3B%0A+++++++schema%3Aauthor+%3Fuser+.%0A%7D' -H 'Accept: application/sparql-results+json,*/*;q=0.9'
  - seen [here](https://wdhqs.wmflabs.org/#query=%23+Number+of+Wikidata+users+who+have+added+or+removed+wd%3AP50+(author)+statements%0A%0APREFIX+schema%3A+%3Chttp%3A%2F%2Fschema.org%2F%3E%0APREFIX+hist%3A+%3Chttp%3A%2F%2Fwikiba.se%2Fhistory%2Fontology%23%3E%0APREFIX+wdt%3A+%3Chttp%3A%2F%2Fwww.wikidata.org%2Fprop%2Fdirect%2F%3E%0A%0ASELECT+(COUNT(DISTINCT+%3Fuser)+AS+%3Fcount)+WHERE+%7B%0A++GRAPH+%3FaddOrDel+%7B%0A++++%3Fitem+wdt%3AP50+%3Fvalue+.%0A++%7D%0A++%3Frev+hist%3Aadditions%7Chist%3Adeletions+%3FaddOrDel+%3B%0A+++++++schema%3Aauthor+%3Fuser+.%0A%7D)
- See also [pipelining SPARQL queries](http://www.snee.com/bobdc.blog/2018/08/pipelining-sparql-queries-in-m.html)

# SPARQL on PAWS using RDFlib
- Finding substrings in title string (via [StackOverflow](https://stackoverflow.com/questions/54162289/finding-the-three-longest-substrings-in-a-string-using-sparql-on-the-wikidata-qu)):
  - [grouped by title](https://paws-public.wmflabs.org/paws-public/User:Luitzen/Stack/Split%20titles.ipynb?kernel_name=python3)
  - [aggregated across titles](https://paws-public.wmflabs.org/paws-public/User:Luitzen/Stack/Split%20titles%201.ipynb)
- [with iframes](https://paws-public.wmflabs.org/paws-public/User:Fuzheado/CMA%20OA%20results.ipynb) (Scholia-like)


# Learning experiences

* [First SPARQL query](https://twitter.com/SiobhanLeachman/status/895382625749159937)
* ["Every time, I have to learn SPARQL from scratch."](https://twitter.com/EconAndrew/status/1097505907800453120)

# See also 
* [SQL vs. SPARQL](https://www.cambridgesemantics.com/blog/semantic-university/learn-sparql/sparql-vs-sql/)
